# the iris dataset is already built-in Rstudio
data(iris)

# I give a name to each variable so it is easier to do the graphs
PL <- iris$Petal.Length
PW <- iris$Petal.Width
SL <- iris$Sepal.Length
SW <- iris$Sepal.Width

# Exercise 1
# to do a scatterplot of each species I have to recall them and give them a name
virginica <- iris[iris$Sps=="virginica",]
setosa <- iris[iris$Sps=="setosa",]
versicolor <- iris[iris$Sps=="versicolor",]


# Now I can do a framework with both the scatterplot
par(mfrow=c(2,1))
# now I can do a scatterplot comparing the length and the width of the petal, giving each species a different color

plot(PW, PL, col=iris$Species,      # I use the function plot() specifing that I want to see the the petal data using $
main="Petal length vs width",        # I give the name to the plot
xlab="Petal Width",                  # I decide that x is the width
ylab="Petal Length",                 # I decide that y is the length
pch=19)

# now I want to add the legend, specifing which species is which color
legend(x="topleft",legend = c('setosa','versicolor','virginica'),  # I use the function legend()
  col = unique(iris$Species), lty = 1, cex=0.5,) # I specify the colors and the size of the legend

# Now I do the scatterplot comparing the length and the width of the sepal, adding the legend
plot(SW, SL, col=iris$Species,      # I use the function plot() specifing that I want to see the the petal data using $
main="Sepal length vs width",        # I give the name to the plot
xlab="Sepal Width",                  # I decide that x is the width
ylab="Sepal Length",                 # I decide that y is the length
pch=19)

legend(x="topleft",legend = c('setosa','versicolor','virginica'),  # I use the function legend()
  col = unique(iris$Species), lty = 1, cex=0.5,)



# exercise 2
# To do a linear regression I have to use the function lm()

lm(Petal.Width ~ Petal.Length, data=iris)$coefficients    # It gives me the results of the equation ???? capisci meglio

plot(PW, PL, col=iris$Species,      # I plot again the graph
main="Petal length vs width",        
xlab="Petal Width",                  
ylab="Petal Length",                 
pch=19)

# And I add the line resulted by the linear regression
abline(lm(Petal.Length ~ Petal.Width, data=iris)$coefficients, col="black")


# I do the same thing with the linear regression of the sepal

lm(Sepal.Width ~ Sepal.Length, data=iris)$coefficients

plot(SW, SL, col=iris$Species,      
main="Sepal length vs width",       
xlab="Sepal Width",                  
ylab="Sepal Length",      
pch=19)

abline(lm(Sepal.Length ~ Sepal.Width, data=iris)$coefficients, col="black")

# Exercise 3

# I do the nromality test of the two variables with the shapiro test

shapiro.test(PW)

shapiro.test(SW)

# I build an histogram for sepal width

hist(SW, freq=FALSE, main="Histogram of Sepal Width",   # I use the function 'hist' to generate an histogramm, and the option freq=FALSE to plot probability densities instead of frequencies. 
xlab="Sepal Width")

# now I create and put the density line on the plot

lines(density(SW))

# I do the same with petal width

hist(PW, freq=FALSE, main="Histogram of Petal Width", 
xlab="Petal Width")
lines(density(PW))

